2])
plot_dat0 <- tibble(time = aj_fit$time, risk = aj_fit$pstate[0,
2])
View(aj_fit)
#creating plotable data
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
survmodel_s1q9$surv))
s1q10_kmplot<-ggplot() + geom_step(data = q9_plot_dat, aes(x = Year,
y = Risk), direction = "hv") + scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0, 0), limits = c(0,1)) + labs(
title = "Cumulative Distribution Function Using KM Estimator",
tag = "Grey Theme",
x = "year",
y = "Risk of Death from Any Cause",) + theme_gray()
ggsave(here::here("output/question9_plot.png"), plot = s1q10_kmplot, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/question9_plot.png"))
#creating plotable data
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
survmodel_s1q9$surv))
s1q10_kmplot<-ggplot() + geom_step(data = q9_plot_dat, aes(x = Year,
y = Risk), direction = "hv") + scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0, 0), limits = c(0,1)) + labs(
title = "Cumulative Distribution Function Using KM Estimator",
tag = "Question 9 Plot",
x = "year",
y = "Risk of Death from Any Cause",) + theme_gray()
ggsave(here::here("output/question9_plot.png"), plot = s1q10_kmplot, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/question9_plot.png"))
#Grey CIF function & plotting
gray_cif <- cuminc(section1$stop, section1$outcome, cencode = 0)
str(gray_cif)
s1q13_graycif <- tibble(time = gray_cif$`1 1`$time, risk = gray_cif$`1 1`$est, Outcome = 1)
#AJ fit
s1q13_aj_fit <- survfit(Surv(time = stop, event = outcome) ~ 1, data=section1)
s1q13_AJ <- tibble(time = s1q13_aj_fit$time, risk = s1q13_aj_fit$pstate[,#thiis is the part of the code that's not working
2])
#KM (from question 9)
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
survmodel_s1q9$surv))
s1q13_plot<- ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk))
geom_step(data = q9_plot_dat, aes(x=time, y=risk))
#example from notes
aj_fit <- survfit(Surv(time = stop, event = outcome) ~ 1, data = cohort)
plot_dat0 <- tibble(time = aj_fit$time, risk = aj_fit$pstate[0,
2])
plot_dat1 <- tibble(time = aj_fit$time, risk = aj_fit$pstate[,
3])
ray_cif <- cuminc(section1$stop, section1$outcome, cencode = 0)
str(gray_cif)
s1q13_graycif <- tibble(time = gray_cif$`1 1`$time, risk = gray_cif$`1 1`$est, Outcome = 1)
#AJ fit
s1q13_aj_fit <- survfit(Surv(time = stop, event = outcome) ~ 1, data=section1)
s1q13_AJ <- tibble(time = s1q13_aj_fit$time, risk = s1q13_aj_fit$pstate[,#thiis is the part of the code that's not working
2])
#KM (from question 9)
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
survmodel_s1q9$surv))
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=time, y=risk))
View(q9_plot_dat)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=time, y=Risk))
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=Time, y=Risk))
View(q9_plot_dat)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk))
gray_cif <- cuminc(section1$stop, section1$outcome, cencode = 0)
str(gray_cif)
s1q13_graycif <- tibble(time = gray_cif$`1 1`$time, risk = 1- gray_cif$`1 1`$est, Outcome = 1)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk))
#Grey CIF function & plotting
gray_cif <- cuminc(section1$stop, section1$outcome, cencode = 0)
str(gray_cif)
s1q13_graycif <- tibble(time = gray_cif$`1 1`$time, risk = gray_cif$`1 1`$est, Outcome = 1)
#AJ fit
s1q13_aj_fit <- survfit(Surv(time = stop, event = outcome) ~ 1, data=section1)
s1q13_AJ <- tibble(time = s1q13_aj_fit$time, risk = s1q13_aj_fit$pstate[,#thiis is the part of the code that's not working
2])
#KM (from question 9)
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
survmodel_s1q9$surv))
s1q13_plot<- ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk))
#example from notes
aj_fit <- survfit(Surv(time = stop, event = outcome) ~ 1, data = cohort)
plot_dat0 <- tibble(time = aj_fit$time, risk = aj_fit$pstate[0,
2])
plot_dat1 <- tibble(time = aj_fit$time, risk = aj_fit$pstate[,
3])
#creating plotable data
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
survmodel_s1q9$surv))
s1q10_kmplot<-ggplot() + geom_step(data = q9_plot_dat, aes(x = Year,
y = Risk), direction = "hv") + scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0, 0), limits = c(0,1)) + labs(
title = "Cumulative Distribution Function Using KM Estimator",
tag = "Question 9 Plot",
x = "year",
y = "Risk of Death from Any Cause",) + theme_gray()
ggsave(here::here("output/question9_plot.png"), plot = s1q10_kmplot, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/question9_plot.png"))
#creating plotable data
q9_plot_dat <- tibble(Year = c(0, 1-survmodel_s1q9$time), Risk = c(0,
survmodel_s1q9$surv))
s1q10_kmplot<-ggplot() + geom_step(data = q9_plot_dat, aes(x = Year,
y = Risk), direction = "hv") + scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0, 0), limits = c(0,1)) + labs(
title = "Cumulative Distribution Function Using KM Estimator",
tag = "Question 9 Plot",
x = "year",
y = "Risk of Death from Any Cause",) + theme_gray()
ggsave(here::here("output/question9_plot.png"), plot = s1q10_kmplot, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/question9_plot.png"))
#creating plotable data
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
1-survmodel_s1q9$surv))
s1q10_kmplot<-ggplot() + geom_step(data = q9_plot_dat, aes(x = Year,
y = Risk), direction = "hv") + scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0, 0), limits = c(0,1)) + labs(
title = "Cumulative Distribution Function Using KM Estimator",
tag = "Question 9 Plot",
x = "year",
y = "Risk of Death from Any Cause",) + theme_gray()
ggsave(here::here("output/question9_plot.png"), plot = s1q10_kmplot, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/question9_plot.png"))
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk))
s1q3p1<- ggplot(s1q3) + geom_linerange(aes(y = ID, xmin = start, xmax = stop, group = outcome)) +
geom_point(aes(x=stop, y=ID, shape=(as.factor(outcome)), color=(as.factor(outcome)))) +
labs(
title = "Line plot for Random Sample n=25",
tag = "Classic theme",
x = "year",
y = "ID",) + theme_classic()
s1q3p2<- ggplot(s1q3) + geom_linerange(aes(y = ID, xmin = start, xmax = stop, group = outcome)) +
geom_point(aes(x=stop, y=ID, shape=(as.factor(outcome)), color=(as.factor(outcome)))) +
labs(
title = "Line plot for Random Sample n=25",
tag = "Grey Theme",
x = "year",
y = "ID",) + theme_gray()
s1q3p3<- ggplot(s1q3) + geom_linerange(aes(y = ID, xmin = start, xmax = stop, group = outcome)) +
geom_point(aes(x=stop, y=ID, shape=(as.factor(outcome)), color=(as.factor(outcome)))) +
labs(
title = "Line plot for Random Sample n=25",
tag = "Light Theme",
x = "year",
y = "ID",) + theme_light()
q3grid<-s1q3p1 + s1q3p2 + s1q3p3
ggsave(here::here("output/question_3_grids.png"), plot = q3grid, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/question_3_grids.png"))
View(s1q13_AJ)
View(s1q13_aj_fit)
ajsection1 <- read_csv(here::here("data/section1.csv")) %>%
mutate(outcome = factor(outcome, 0:2, labels = c("censor",
"event", "competing risk"))) # note converted to fac table(cohort$outcome)
s1q13_aj_fit <- survfit(Surv(time = stop, event = outcome) ~ 1, data=ajsection1)
s1q13_AJ <- tibble(time = s1q13_aj_fit$time, risk = s1q13_aj_fit$pstate[,#thiis is the part of the code that's not working
2])
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk), linetype=2) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk)) +
geom_step(data = s1q13_AJ, aes(x=Year, y=Risk))
View(s1q13_AJ)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk), linetype=2) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk)) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk))
#Grey CIF function & plotting
gray_cif <- cuminc(section1$stop, section1$outcome, cencode = 0)
str(gray_cif)
s1q13_graycif <- tibble(time = gray_cif$`1 1`$time, risk = gray_cif$`1 1`$est, Outcome = 1)
#AJ fit
ajsection1 <- read_csv(here::here("data/section1.csv")) %>%
mutate(outcome = factor(outcome, 0:2, labels = c("censor",
"event", "competing risk"))) # note converted to fac table(cohort$outcome)
s1q13_aj_fit <- survfit(Surv(time = stop, event = outcome) ~ 1, data=ajsection1)
s1q13_AJ <- tibble(time = s1q13_aj_fit$time, risk = s1q13_aj_fit$pstate[,#thiis is the part of the code that's not working
2])
#KM (from question 9)
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
survmodel_s1q9$surv))
s1q13_plot<-
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk), linetype=2) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk)) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk))
library(boot)
library(table1)
library(here)
library(ggplot2)
library(survival)
library(dplyr)
library(cmprsk)
#Loading Data
library(readr)
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
here::i_am("assignment/Section1_Assignment_2023.Rmd")
section1 <- read_csv(here::here("data/section1.csv"))
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), linetype=2) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk), color = "#D55E00")
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
survmodel_s1q9$surv))
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), linetype=2) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk), color = "#D55E00")
#creating plotable data
q9_plot_dat <- tibble(Year = c(0, survmodel_s1q9$time), Risk = c(0,
1-survmodel_s1q9$surv))
s1q10_kmplot<-ggplot() + geom_step(data = q9_plot_dat, aes(x = Year,
y = Risk), direction = "hv") + scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0, 0), limits = c(0,1)) + labs(
title = "Cumulative Distribution Function Using KM Estimator",
tag = "Question 9 Plot",
x = "year",
y = "Risk of Death from Any Cause",) + theme_gray()
ggsave(here::here("output/question9_plot.png"), plot = s1q10_kmplot, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/question9_plot.png"))
#Grey CIF function & plotting
gray_cif <- cuminc(section1$stop, section1$outcome, cencode = 0)
str(gray_cif)
s1q13_graycif <- tibble(time = gray_cif$`1 1`$time, risk = gray_cif$`1 1`$est, Outcome = 1)
#AJ fit
ajsection1 <- read_csv(here::here("data/section1.csv")) %>%
mutate(outcome = factor(outcome, 0:2, labels = c("censor",
"event", "competing risk"))) # note converted to fac table(cohort$outcome)
s1q13_aj_fit <- survfit(Surv(time = stop, event = outcome) ~ 1, data=ajsection1)
s1q13_AJ <- tibble(time = s1q13_aj_fit$time, risk = s1q13_aj_fit$pstate[,#thiis is the part of the code that's not working
2])
#KM (from question 9)
s1q13_plot<-
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), linetype=2) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk), color = "#D55E00")
View(q9_plot_dat)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk)) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), linetype=2) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk), color = "#D55E00")
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),linetype=2) +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), linetype=1) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk), color = "#D55E00")
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#D55E00") +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), linetype=1) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#D55E00") +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), linetype=3) +
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#FB6F90") +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFCOCB") +
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time on Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#FB6F90") +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFC0CB") +
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time in Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#ff1a8c") +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFC0CB") +
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2)
str(gray_cif)
s1q13_graycif <- tibble(time = gray_cif$`1 1`$time, risk = gray_cif$`1 1`$est, Outcome = 1)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time in Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#ff1a8c") +
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFC0CB") +
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2)
#Grey CIF function & plotting
gray_cif <- cuminc(section1$stop, section1$outcome, cencode = 0)
str(gray_cif)
s1q13_graycif <- tibble(time = gray_cif$`1 1`$time, risk = gray_cif$`1 1`$est, Outcome = 1)
#AJ fit
ajsection1 <- read_csv(here::here("data/section1.csv")) %>%
mutate(outcome = factor(outcome, 0:2, labels = c("censor",
"event", "competing risk"))) # note converted to fac table(cohort$outcome)
s1q13_aj_fit <- survfit(Surv(time = stop, event = outcome) ~ 1, data=ajsection1)
s1q13_AJ <- tibble(time = s1q13_aj_fit$time, risk = s1q13_aj_fit$pstate[,#this is the part of the code that's not working
2])
#KM (from question 9)
s1q13figure <-ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time in Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#ff1a8c") + #gray cif plot
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFC0CB") + #km curve from question 9
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2) #
ggsave(here::here("output/s1q13figure.png"), plot = s1q13figure, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/s1q13figure.png"))
s1q3p1<- ggplot(s1q3) + geom_linerange(aes(y = ID, xmin = start, xmax = stop, group = outcome)) +
geom_point(aes(x=stop, y=ID, shape=(as.factor(outcome)), color=(as.factor(outcome)))) +
labs(
title = "Line plot for Random Sample n=25",
tag = "Classic theme",
x = "year",
y = "ID",) + theme_classic()
s1q3p2<- ggplot(s1q3) + geom_linerange(aes(y = ID, xmin = start, xmax = stop, group = outcome)) +
geom_point(aes(x=stop, y=ID, shape=(as.factor(outcome)), color=(as.factor(outcome)))) +
labs(
title = "Line plot for Random Sample n=25",
tag = "Grey Theme",
x = "year",
y = "ID",) + theme_gray()
s1q3p3<- ggplot(s1q3) + geom_linerange(aes(y = ID, xmin = start, xmax = stop, group = outcome)) +
geom_point(aes(x=stop, y=ID, shape=(as.factor(outcome)), color=(as.factor(outcome)))) +
labs(
title = "Line plot for Random Sample n=25",
tag = "Light Theme",
x = "year",
y = "ID",) + theme_light()
q3grid<-s1q3p1 + s1q3p2 + s1q3p3
ggsave(here::here("output/question_3_grids.png"), plot = q3grid, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/question_3_grids.png"))
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time in Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk, group=time),color = "#ff1a8c") + #gray cif plot
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk, group=Year), color="#FFC0CB") + #km curve from question 9
geom_step(data = s1q13_AJ, aes(x=time, y=risk, group=time),linetype=2)
ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time in Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#ff1a8c") + #gray cif plot
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFC0CB") + #km curve from question 9
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2) #
```{r question 13, echo=FALSE}
s1q13figure <-ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time in Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#ff1a8c") + #gray cif plot
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFC0CB") + #km curve from question 9
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2) #
+ labs(
title = "single plot of the cause-specific and sub-distribution risk for outcome=1 using the Kaplan-Meier, Aalen-Johansen, and Gray's CIF estimators",
tag = "light pink = Kaplan-Meier curve; dark pink = Gray's CIF Estimator; dashed line = Aalen-Johansen ",
x = "time",
y = "ID",)
s1q13figure <-ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time in Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#ff1a8c") + #gray cif plot
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFC0CB") + #km curve from question 9
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2) #
+ labs(
title = "single plot of the cause-specific and sub-distribution risk for outcome=1",
tag = "light pink = Kaplan-Meier curve; dark pink = Gray's CIF Estimator; dashed line = Aalen-Johansen ",
x = "time",
y = "ID",)
s1q13figure <-ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time in Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#ff1a8c") + #gray cif plot
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFC0CB") + #km curve from question 9
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2) #
+ labs(
title = " plot of the cause-specific and sub-distribution risk",
tag = "light pink = Kaplan-Meier curve; dark pink = Gray's CIF Estimator; dashed line = Aalen-Johansen ",
x = "time",
y = "ID",)
s1q13figure <-ggplot() + scale_y_continuous(expand=c(0,0), limits = c(0,1)) +
scale_x_continuous(expand = c(0,0)) +
ylab("Risks") +
xlab("Time in Study") +
geom_step(data = s1q13_graycif, aes(x=time, y=risk),color = "#ff1a8c") + #gray cif plot
geom_step(data = q9_plot_dat, aes(x=Year, y=Risk), color="#FFC0CB") + #km curve from question 9
geom_step(data = s1q13_AJ, aes(x=time, y=risk),linetype=2) + labs(
title = " plot of the cause-specific and sub-distribution risk",
tag = "light pink = Kaplan-Meier curve; dark pink = Gray's CIF Estimator; dashed line = Aalen-Johansen ",
x = "time",
y = "ID",)
ggsave(here::here("output/s1q13figure.png"), plot = s1q13figure, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/s1q13figure.png"))
s1q3p1<- ggplot(s1q3) + geom_linerange(aes(y = ID, xmin = start, xmax = stop, group = outcome)) +
geom_point(aes(x=stop, y=ID, shape=(as.factor(outcome)), color=(as.factor(outcome)))) +
labs(
title = "Line plot for Random Sample n=25",
tag = "Classic theme",
x = "year",
y = "ID",) + theme_classic()
s1q3p2<- ggplot(s1q3) + geom_linerange(aes(y = ID, xmin = start, xmax = stop, group = outcome)) +
geom_point(aes(x=stop, y=ID, shape=(as.factor(outcome)), color=(as.factor(outcome)))) +
labs(
title = "Line plot for Random Sample n=25",
tag = "Grey Theme",
x = "year",
y = "ID",) + theme_gray()
s1q3p3<- ggplot(s1q3) + geom_linerange(aes(y = ID, xmin = start, xmax = stop, group = outcome)) +
geom_point(aes(x=stop, y=ID, shape=(as.factor(outcome)), color=(as.factor(outcome)))) +
labs(
title = "Line plot for Random Sample n=25",
tag = "Light Theme",
x = "year",
y = "ID",) + theme_light()
q3grid<-s1q3p1 + s1q3p2 + s1q3p3
ggsave(here::here("output/question_3_grids.png"), plot = q3grid, scale=1, width=20, height=5, dpi=70)
knitr::include_graphics(here::here("output/question_3_grids.png"))
section1_expl <-section1
#creating tbale 1 of Exposure x Outcome
section1_expl$outcome1 <-
factor(section1$outcome,
levels=c(0,1,2),
labels=c("no outcome", # Reference
"outcome 1",
"outcome 2"))
section1_expl$exposure1 <-
factor(section1$exposure,
levels=c(0,1),
labels=c("no exposure",
"exposure"))
section1_expl$confounder1 <-
factor(section1$confounder,
levels=c(0,1),
labels=c("no confounder",
"confounder"))
table1(~ section1_expl$exposure1 | section1_expl$outcome1*section1_expl$confounder1, data=section1_expl)
#Grey CIF function & plotting
gray_cif <- cuminc(section1$stop, section1$outcome, cencode = 0)
library(boot)
library(table1)
library(here)
library(ggplot2)
library(survival)
library(dplyr)
library(cmprsk)
#Loading Data
library(readr)
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
here::i_am("assignment/Section1_Assignment_2023.Rmd")
section1 <- read_csv(here::here("data/section1.csv"))
