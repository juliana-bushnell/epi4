race,income, marital,school,
asthma,bronch,
starts_with("alcohol"),-alcoholpy,
starts_with("price"),
starts_with("tax"),
starts_with("smoke"),
smkintensity82_71) %>%
mutate(income=as.numeric(income>15),
marital=as.numeric(marital>2),
alcoholfreq=as.numeric(alcoholfreq>1)) %>%
na.omit(.)
nhefs <- nhefs %>%
select(qsmk,wt82_71,wt82, wt71, exercise,sex,age,
race,income, marital,school,
asthma,bronch,
starts_with("alcohol"),-alcoholpy,
starts_with("price"),
starts_with("tax"),
starts_with("smoke"),
smkintensity82_71) %>%
mutate(income=as.numeric(income>15),
marital=as.numeric(marital>2),
alcoholfreq=as.numeric(alcoholfreq>1)) %>%
na.omit(.)
file_loc <- url("https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/1268/20/nhefs.csv")
nhefs <-  read_csv(file_loc) %>%
select(qsmk,wt82_71,wt82, wt71, exercise,sex,age,
race,income, marital,school,
asthma,bronch,
starts_with("alcohol"),-alcoholpy,
starts_with("price"),
starts_with("tax"),
starts_with("smoke"),
smkintensity82_71) %>%
mutate(income=as.numeric(income>15),
marital=as.numeric(marital>2),
alcoholfreq=as.numeric(alcoholfreq>1)) %>%
na.omit(.)
factor_names <- c("exercise","income","marital",
"sex","race","asthma","bronch")
nhefs[,factor_names] <- lapply(nhefs[,factor_names] , factor)
#' Define outcome
nhefs <- nhefs %>% mutate(id = row_number(),
wt_delta = as.numeric(wt82_71>median(wt82_71)),
.before = qsmk)
#' Quick summary of data
nhefs1 %>% print(n=5)
file_loc <- url("https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/1268/20/nhefs.csv")
nhefs <-  read_csv(file_loc) %>%
select(qsmk,wt82_71,wt82, wt71, exercise,sex,age,
race,income, marital,school,
asthma,bronch,
starts_with("alcohol"),-alcoholpy,
starts_with("price"),
starts_with("tax"),
starts_with("smoke"),
smkintensity82_71) %>%
mutate(income=as.numeric(income>15),
marital=as.numeric(marital>2),
alcoholfreq=as.numeric(alcoholfreq>1)) %>%
na.omit(.)
factor_names <- c("exercise","income","marital",
"sex","race","asthma","bronch")
nhefs[,factor_names] <- lapply(nhefs[,factor_names] , factor)
#' Define outcome
nhefs <- nhefs %>% mutate(id = row_number(),
wt_delta = as.numeric(wt82_71>median(wt82_71)),
.before = qsmk)
#' Quick summary of data
nhefs %>% print(n=5)
nhefs$marital <- ifelse(nhefs$marital ==
6, 5, nhefs$marital)
nhefs$marital <- ifelse(nhefs$marital ==
8, 2, nhefs$marital)
table(nhefs$marital)
file_loc <- url("https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/1268/20/nhefs.csv")
nhefs <-  read_csv(file_loc) %>%
select(qsmk,wt82_71,wt82, wt71, exercise,sex,age,
race,income, marital,school,
asthma,bronch,
starts_with("alcohol"),-alcoholpy,
starts_with("price"),
starts_with("tax"),
starts_with("smoke"),
smkintensity82_71) %>%
mutate(income=as.numeric(income>15),
alcoholfreq=as.numeric(alcoholfreq>1)) %>%
na.omit(.)
factor_names <- c("exercise","income","marital",
"sex","race","asthma","bronch")
nhefs[,factor_names] <- lapply(nhefs[,factor_names] , factor)
#' Define outcome
nhefs <- nhefs %>% mutate(id = row_number(),
wt_delta = as.numeric(wt82_71>median(wt82_71)),
.before = qsmk)
#' Quick summary of data
nhefs %>% print(n=5)
nhefs$marital <- ifelse(nhefs$marital ==
6, 5, nhefs$marital)
nhefs$marital <- ifelse(nhefs$marital ==
8, 2, nhefs$marital)
table(nhefs$marital)
nhefs$marital <- ifelse(nhefs$marital ==
6, 5, nhefs$marital)
nhefs$marital <- ifelse(nhefs$marital ==
8, 2, nhefs$marital)
table(nhefs$marital)
file_loc <- here::here("data/nhefs.csv")
nhefs <-  read_csv(file_loc) %>%
select(qsmk,wt82_71,wt82, wt71, exercise,sex,age,
race,income, marital,school,
asthma,bronch,
starts_with("alcohol"),-alcoholpy,
starts_with("price"),
starts_with("tax"),
starts_with("smoke"),
smkintensity82_71) %>%
mutate(income=as.numeric(income>15),
alcoholfreq=as.numeric(alcoholfreq>1)) %>%
na.omit(.)
View(nhefs)
nhefs <-  read_csv(file_loc)
file_loc <- here::here("data/nhefs.csv")
nhefs <-  read_csv(file_loc) %>%
select(qsmk,wt82_71, exercise,sex,age,
race,income, marital,school,
asthma,bronch,
starts_with("alcohol"),-alcoholpy,
starts_with("price"),
starts_with("tax"),
starts_with("smoke"),
smkintensity82_71) %>%
mutate(income=as.numeric(income>15),
alcoholfreq=as.numeric(alcoholfreq>1)) %>%
na.omit(.)
file_loc <- here::here("data/nhefs.csv")
nhefs <-  read_csv(file_loc) %>%
select(qsmk,wt82_71, exercise,sex,age,
race,income, marital,school,
asthma,bronch,
starts_with("price"),
starts_with("tax"),
starts_with("smoke"),
smkintensity82_71) %>%
mutate(income=as.numeric(income>15),
alcoholfreq=as.numeric(alcoholfreq>1)) %>%
na.omit(.)
nhefs$marital <- ifelse(nhefs$marital ==
6, 5, nhefs$marital)
nhefs$marital <- ifelse(nhefs$marital ==
8, 2, nhefs$marital)
table(nhefs$marital)
nhefs$marital <- ifelse(nhefs$marital ==
6, 5, nhefs$marital)
nhefs$marital <- ifelse(nhefs$marital ==
8, 2, nhefs$marital)
table(nhefs$marital)
table(nhefs$smokeintensity)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, here, dplyr, gtsummary, gt, webshot2,sandwich,stats,here, ggplot2 )
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, here, dplyr, gtsummary, gt, webshot2,sandwich,stats,here, ggplot2 )
file_loc <- here::here("data/nhefs.csv")
nhefs <-  read_csv(file_loc)
#' Quick summary of data
nhefs %>% print(n=5)
nhefs$marital <- ifelse(nhefs$marital ==
6, 5, nhefs$marital)
nhefs$marital <- ifelse(nhefs$marital ==
8, 2, nhefs$marital)
table(nhefs$marital)
table(nhefs$smokeintensity)
q3m1 <- glm(high_BP ~ qsmk + bs(smokeintensity) + sex + bs(age) + factor(race) + bs(school) + factor(marital), data = nhefs,
family = binomial("logit"))
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, here, dplyr, gtsummary, gt, webshot2,sandwich,stats,here, ggplot2,stats )
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, here, dplyr, gtsummary, gt, webshot2,sandwich,stats,here, ggplot2,stats, graphics )
q3m1 <- glm(high_BP ~ qsmk + bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3) + factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = binomial("logit"))
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, here, dplyr, gtsummary, gt, webshot2,sandwich,stats,here, ggplot2,stats, graphics, splines )
q3m1 <- glm(high_BP ~ qsmk + bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3) + factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = binomial("logit"))
mu1 <- predict(q3m1, newdata = transform(nhefs, qsmk = 1), type = "response")
mu0 <- predict(q3m1, newdata = transform(nhefs, qsmk = 0), type = "response")
q3m1rr <- mean(mu1)/mean(mu0)
bootfunc <- function(data, index) {
boot_dat <- data[index, ]
mu1 <- predict(q3m1, newdata = transform(boot_dat,
qsmk = 1), type = "response")
mu0 <- predict(q3m1, newdata = transform(boot_dat,
qsmk = 0), type = "response")
marg_stand_RR_ <- mean(mu1)/mean(mu0)
marg_stand_RD_ <- mean(mu1) - mean(mu0)
res <- c(marg_stand_RD_, marg_stand_RR_)
return(res)
}
set.seed(16)
boot_res <- boot(nhefs, bootfunc, R = 2000)
pacman::p_load(tidyverse, here, dplyr, gtsummary, gt, webshot2,sandwich,stats,here, ggplot2,stats, graphics, splines,boot )
bootfunc <- function(data, index) {
boot_dat <- data[index, ]
mu1 <- predict(q3m1, newdata = transform(boot_dat,
qsmk = 1), type = "response")
mu0 <- predict(q3m1, newdata = transform(boot_dat,
qsmk = 0), type = "response")
marg_stand_RR_ <- mean(mu1)/mean(mu0)
marg_stand_RD_ <- mean(mu1) - mean(mu0)
res <- c(marg_stand_RD_, marg_stand_RR_)
return(res)
}
set.seed(16)
boot_res <- boot(nhefs, bootfunc, R = 2000)
boot_RD <- boot.ci(boot_res, index = 1)
boot_RR <- boot.ci(boot_res, index = 2)
marg_stand_RR_
marg_stand_RD_
boot_RD
boot_RR
marg_stand_RR_
marg_stand_RD_
boot_RD
boot_RR
q3m2rd <- glm(high_BP ~ qsmk + bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3) +
factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = gaussian(link = "identity"))
SE.q3m2rd<-sqrt(sandwich(q3m2rd)[2, 2])
q3m3rr <- glm(high_BP ~ qsmk + bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3) +
factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = poisson(link ="log"))
SE.q3m3rr<-sqrt(sandwich(q3m3rr)[2, 2])
nhefs$propensity_score <- glm(high_BP ~ qsmk + bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3)
+ factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = binomial("logit"))$fitted.values
q5m1 <- glm(high_BP ~ qsmk +propensity_score+ bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3)
+ factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = binomial("logit"))
summary(q5m1)$coefficients[2,]
bootfunc <- function(data, index) {
boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
}
set.seed(16)
q5boot_res <- boot(nhefs, bootfunc, R = 2000)
q5bootfunc <- function(data, index) {
boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
}
set.seed(16)
q5boot_res <- boot(nhefs, q5bootfunc, R = 2000)
q5boot_RD <- boot.ci(q5boot_res, index = 1)
q5boot_RR <- boot.ci(q5boot_res, index = 2)
q5marg_stand_RR_
set.seed(16)
q5boot_res <- boot(nhefs, q5bootfunc, R = 2000)
q5bootfunc <- function(data, index) {
q5boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
}
set.seed(16)
q5boot_res <- boot(nhefs, q5bootfunc, R = 2000)
q5boot_RD <- boot.ci(q5boot_res, index = 1)
q5boot_RR <- boot.ci(q5boot_res, index = 2)
q5bootfunc <- function(data, index) {
q5boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
}
q5bootfunc <- function(data, index) {
q5boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
}
q5mu1 <- predict(q5m1, newdata = transform(nhefs, qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(nhefs, qsmk = 0), type = "response")
q3m1rr <- mean(q5mu1)/mean(q5mu0)
q5bootfunc <- function(data, index) {
q5boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
}
set.seed(16)
q5boot_res <- boot(nhefs, q5bootfunc, R = 2000)
q5boot_RD <- boot.ci(q5boot_res, index = 1)
q5boot_RR <- boot.ci(q5boot_res, index = 2)
marg_stand_RR_
marg_stand_RD_
boot_RD
boot_RR
marg_stand_RR_
marg_stand_RD_
boot_RD
boot_RR
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
q5marg_stand_RR_
q5marg_stand_RD_
q5boot_RD
q5boot_RR
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, here, dplyr, gtsummary, gt, webshot2,sandwich,stats,here, ggplot2,stats, graphics, splines,boot )
# stabilized inverse probability
# weights
nhefs$sw <- (mean(nhefs$high_BP)/nhefs$high_BP) *
nhefs$high_BP + ((1 - mean(nhefs$high_BP))/(1 -
nhefs$propensity_score)) * (1 - nhefs$high_BP)
summary(nhefs$sw)
marg_stand_RR_
marg_stand_RD_
boot_RD
boot_RR
q3m2rd <- glm(high_BP ~ qsmk + bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3) +
factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = gaussian(link = "identity"))
SE.q3m2rd<-sqrt(sandwich(q3m2rd)[2, 2])
q3m3rr <- glm(high_BP ~ qsmk + bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3) +
factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = poisson(link ="log"))
SE.q3m3rr<-sqrt(sandwich(q3m3rr)[2, 2])
SE.q3m3rr
SE.q3m2rd
q3m2rd
nhefs$propensity_score <- glm(high_BP ~ qsmk + bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3)
+ factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = binomial("logit"))$fitted.values
# stabilized inverse probability
# weights
nhefs$sw <- (mean(nhefs$high_BP)/nhefs$high_BP) *
nhefs$high_BP + ((1 - mean(nhefs$high_BP))/(1 -
nhefs$propensity_score)) * (1 - nhefs$high_BP)
summary(nhefs$sw)
q5m1 <- glm(high_BP ~ qsmk +propensity_score+ bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3)
+ factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = binomial("logit"))
summary(q5m1)$coefficients[2,]
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5bootfunc <- function(data, index) {
q5boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 0), type = "response")
set.seed(16)
q5boot_res <- boot(nhefs, q5bootfunc, R = 2000)
q5boot_RD <- boot.ci(q5boot_res, index = 1)
q5boot_RR <- boot.ci(q5boot_res, index = 2)
set.seed(16)
q5boot_res <- boot(nhefs, q5bootfunc, R = 2000)
q5boot_RD <- boot.ci(q5boot_res, index = 1)
q5boot_RR <- boot.ci(q5boot_res, index = 2)
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5boot_dat <- data[index, ]
q5bootfunc <- function(data, index)
q5bootfunc <- function(data, index) {
q5boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
}
q5boot_dat <- data[index, ]
q5bootfunc <- function(data, index) {
q5boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
}
bootfunc <- function(data, index) {
boot_dat <- data[index, ]
mu1 <- predict(q3m1, newdata = transform(boot_dat,
qsmk = 1), type = "response")
mu0 <- predict(q3m1, newdata = transform(boot_dat,
qsmk = 0), type = "response")
marg_stand_RR_ <- mean(mu1)/mean(mu0)
marg_stand_RD_ <- mean(mu1) - mean(mu0)
res <- c(marg_stand_RD_, marg_stand_RR_)
return(res)
}
set.seed(16)
boot_res <- boot(nhefs, bootfunc, R = 2000)
boot_RD <- boot.ci(boot_res, index = 1)
boot_RR <- boot.ci(boot_res, index = 2)
marg_stand_RR_
marg_stand_RD_
boot_RD
boot_RR
nhefs$propensity_score <- glm(high_BP ~ qsmk + bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3)
+ factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = binomial("logit"))$fitted.values
# stabilized inverse probability
# weights
nhefs$sw <- (mean(nhefs$high_BP)/nhefs$high_BP) *
nhefs$high_BP + ((1 - mean(nhefs$high_BP))/(1 -
nhefs$propensity_score)) * (1 - nhefs$high_BP)
summary(nhefs$sw)
q5m1 <- glm(high_BP ~ qsmk +propensity_score+ bs(smokeintensity, df=3, degree=3) + sex + bs(age, df=3, degree=3)
+ factor(race) + bs(school, df=3, degree=3) + factor(marital), data = nhefs,
family = binomial("logit"))
summary(q5m1)$coefficients[2,]
q5bootfunc <- function(data, index) {
q5boot_dat <- data[index, ]
q5mu1 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 1), type = "response")
q5mu0 <- predict(q5m1, newdata = transform(q5boot_dat,
qsmk = 0), type = "response")
q5marg_stand_RR_ <- mean(q5mu1)/mean(q5mu0)
q5marg_stand_RD_ <- mean(q5mu1) - mean(q5mu0)
res <- c(q5marg_stand_RD_, q5marg_stand_RR_)
return(res)
}
set.seed(16)
q5boot_res <- boot(nhefs, q5bootfunc, R = 2000)
q5boot_RD <- boot.ci(q5boot_res, index = 1)
q5boot_RR <- boot.ci(q5boot_res, index = 2)
q5marg_stand_RR_
q5marg_stand_RD_
q5boot_RD
q5boot_RR
q5marg_stand_RR_
q5marg_stand_RD_
q5boot_RD
q5boot_RR
View(nhefs)
file_loc <- here::here("data/nhefs.csv")
nhefs <-  read_csv(file_loc)
#' Quick summary of data
nhefs %>% print(n=5)
knitr::opts_chunk$set(echo = TRUE)
here::i_am("assignment/Section3_Assignment_2023.Rmd")
pacman::p_load(tidyverse, here, dplyr, gtsummary, gt, webshot2,sandwich,stats,here, ggplot2,stats, graphics, splines,boot )
file_loc <- here::here("data/nhefs.csv")
nhefs <-  read_csv(file_loc)
#' Quick summary of data
nhefs %>% print(n=5)
nhefs$marital <- ifelse(nhefs$marital ==
6, 5, nhefs$marital)
nhefs$marital <- ifelse(nhefs$marital ==
8, 2, nhefs$marital)
table(nhefs$marital)
q2m1 <-  glm(highbp ~ bs(smokeintensity, df=3, degree=3), data = nhefs, family = poisson(link = "log"))
table(nhefs$high_bp)
table(nhefs$high_BP)
q2m1 <-  glm(high_BP ~ bs(smokeintensity, df=3, degree=3), data = nhefs, family = poisson(link = "log"))
summary(q2m1)$coefficients[, 1:2]
table(nhefs$smokeintensity)
q2m1 <-  glm(high_BP ~ bs(smokeintensity, df=3, degree=3), data = nhefs, family = binomial(link = "log"))
q2m1 <-  glm(high_BP ~ bs(smokeintensity, df=3, degree=3), data = nhefs, family = poisson(link = "log"))
